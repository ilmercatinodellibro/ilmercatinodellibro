fragment BookCopySummary on BookCopy {
  id
  code
  originalCode
}

fragment ProblemDetails on Problem {
  id
  createdAt
  createdBy {
    ...UserSummary
  }
  details
  resolvedAt
  resolvedBy {
    ...UserSummary
  }
  solution
  type
  updatedAt
}

fragment BookCopyDetails on BookCopy {
  ...BookCopySummary
  createdAt
  createdById
  book {
    ...BookSummary
    retailLocationId
  }
  problems {
    ...ProblemDetails
  }
  purchasedAt
  purchasedBy {
    ...UserSummary
  }
  owner {
    ...UserSummary
  }
  returnedAt
  returnedById
  updatedAt
  updatedById
}

query getBookCopies($bookId: String!) {
  bookCopies(bookId: $bookId) {
    ...BookCopyDetails
  }
}

query getBookCopiesByOwner($retailLocationId: String!, $userId: String!) {
  bookCopiesByOwner(retailLocationId: $retailLocationId, userId: $userId) {
    ...BookCopyDetails
  }
}

query getPurchasedBookCopies($retailLocationId: String!, $userId: String!) {
  purchasedBookCopies(retailLocationId: $retailLocationId, userId: $userId) {
    ...BookCopyDetails
  }
}

query getSoldBookCopies($retailLocationId: String!, $userId: String!) {
  soldBookCopies(retailLocationId: $retailLocationId, userId: $userId) {
    ...BookCopyDetails
  }
}

query getReturnedBookCopies($retailLocationId: String!, $userId: String!) {
  returnedBookCopies(retailLocationId: $retailLocationId, userId: $userId) {
    ...BookCopyDetails
  }
}

mutation createBookCopies($input: BookCopyCreateInput!) {
  createBookCopies(input: $input) {
    ...BookCopyDetails
  }
}

mutation reportProblem($input: ProblemCreateInput!) {
  reportProblem(input: $input) {
    id
    bookCopyId
    details
  }
}

mutation resolveProblem($input: ProblemResolveInput!) {
  resolveProblem(input: $input) {
    id
    bookCopyId
    details
    solution
  }
}
