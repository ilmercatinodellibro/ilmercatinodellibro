fragment BookSummary on Book {
  id
  isbnCode
  subject
  authorsFullName
  title
  originalPrice
  publisherName

  # TODO: Make this only used for admin/operator routes as it's not needed for customers and is costly
  utility {
    value
    booksTaken
    booksInWarehouse
    booksSold
    requestsActive
    requestsTotal
  }

  meta {
    id

    isAvailable
    availableCount

    copiesCount
    problemsCount
    soldCount
    reservationsCount
    cartItemsCount
  }
}

fragment PaginatedBookResult on BookQueryResult {
  page
  rows {
    ...BookSummary
  }
  rowsCount
}

query getBooks(
  $retailLocationId: String!
  $page: Int!
  $rows: Int!
  $filter: BookQueryFilter
) {
  books(
    retailLocationId: $retailLocationId
    page: $page
    rows: $rows
    filter: $filter
  ) {
    ...PaginatedBookResult
  }
}

query getBooksWithCopies(
  $retailLocationId: String!
  $page: Int!
  $rows: Int!
  $filter: BookQueryFilter
) {
  books(
    retailLocationId: $retailLocationId
    page: $page
    rows: $rows
    filter: $filter
    withCopies: true
  ) {
    ...PaginatedBookResult
  }
}

query getBookByIsbn($isbnCode: String!, $retailLocationId: String!) {
  books(
    retailLocationId: $retailLocationId
    page: 0
    rows: 1
    filter: { search: $isbnCode }
  ) {
    rows {
      ...BookSummary
    }
  }
}

mutation createNewBook($input: BookCreateInput!) {
  createBook(input: $input) {
    ...BookSummary
  }
}
